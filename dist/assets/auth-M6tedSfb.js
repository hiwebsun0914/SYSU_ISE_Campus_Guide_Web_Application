import{m as i}from"./index-DEgG3K8i.js";import{r as f}from"./request-DF8rRKj-.js";const e="token",a="userInfo";function g(n){localStorage.setItem(e,n||"")}function r(){return localStorage.getItem(e)||""}function m(){localStorage.removeItem(e)}function I(){return!!r()}function t(n){const s=n||window.location.pathname+window.location.search;i.push({path:"/signin",query:{redirect:s}})}async function S(n=""){var c;if(!r())return t(n),null;try{const o=await f({url:"/auth/me",method:"GET"});if((o==null?void 0:o.code)===1)return t(n),null;const u=(o==null?void 0:o.userInfo)||{},l=JSON.parse(localStorage.getItem(a)||"{}");return localStorage.setItem(a,JSON.stringify({...l,...u})),u}catch(o){return((c=o==null?void 0:o.response)==null?void 0:c.status)===401?(t(n),null):(console.error("[getUserInfo] error:",o),null)}}const k={isLoggedIn:I,getUserInfo:S,setToken:g,getToken:r,clearToken:m};export{k as a};
