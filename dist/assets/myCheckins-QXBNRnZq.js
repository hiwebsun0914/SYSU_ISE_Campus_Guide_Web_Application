import{_ as B,r as l,o as J,u as K,b as T,d as m,e as a,f as N,t as p,j as V,F as D,g as F,w as P,h as y,i as Y,k as G}from"./index-DEgG3K8i.js";import{r as j}from"./request-DF8rRKj-.js";const H={class:"content"},W={class:"user-card"},Q=["src"],X={class:"user-meta"},Z={class:"user-name"},nn={class:"user-id"},sn={class:"progress"},en={class:"progress-label"},an={class:"progress-bar"},on={class:"badge-grid"},_n=["onClick"],tn=["title"],un=["alt"],ln={key:0,class:"badge-mask"},cn={class:"badge-name"},dn={key:0,class:"loading"},q="MYCHECKINS_USER_V1",O="MYCHECKINS_UNLOCK_SET_V1",n="https://sysuzngcxy-1322240898.cos.ap-guangzhou.myqcloud.com/Badge",gn={__name:"myCheckins",setup(rn){const E={mounted(i,s){const e=s.value;if(e)if(i.setAttribute("data-src",e),"IntersectionObserver"in window){const o=new IntersectionObserver(([t])=>{t.isIntersecting&&(i.src=e,o.unobserve(i))},{rootMargin:"300px"});o.observe(i),i.__lazyIo__=o}else i.src=e},unmounted(i){var s,e;(e=(s=i.__lazyIo__)==null?void 0:s.disconnect)==null||e.call(s),delete i.__lazyIo__}};function w(i,s=256,e=75){if(!i)return"";const o=`imageMogr2/thumbnail/${s}x/format/webp/quality/${e}`;return i.includes("?")?`${i}&${o}`:`${i}?${o}`}const S=[{id:1,name:"ä½•å°”è¾¾å±‹",icon:`${n}/sysu_001_he_er_da_house.png`},{id:2,name:"é«˜åˆ©å£«å±‹",icon:`${n}/sysu_002_gao_lishi_house.png`},{id:3,name:"å®¾çœæ ¡å±‹",icon:`${n}/sysu_003_pennsylvania_school_house.png`},{id:4,name:"ç«¯æœ¨æ­£æ•™æŽˆåƒ",icon:`${n}/sysu_004_prof_duanmu_zheng_statue.png`},{id:5,name:"éŸ¦è€¶å­å®žå±‹",icon:`${n}/sysu_005_wei_yexiaoshi_house.png`},{id:6,name:"ä¼¦æ•¦ä¼šå±‹",icon:`${n}/sysu_006_london_missionary_society_house.png`},{id:7,name:"ç¾Žè‡£å±‹ä¸€å·",icon:`${n}/sysu_007_meichen_house_no1.png`},{id:8,name:"ç™½å¾·ç†å±‹",icon:`${n}/sysu_008_bai_deli_house.png`},{id:9,name:"å±ˆæž—å®¾å±‹",icon:`${n}/sysu_009_qu_linbin_house.png`},{id:10,name:"æƒ å¸ˆç¤¼å±‹",icon:`${n}/sysu_010_hui_shili_house.png`},{id:11,name:"é©¬å²—å ‚",icon:`${n}/sysu_011_magang_hall.png`},{id:12,name:"å›¾ä¹¦é¦†",icon:`${n}/sysu_012_library.png`},{id:13,name:"é»„ç„•ç§‹æ ¡é•¿åƒ",icon:`${n}/sysu_013_zou_lu_president_statue.png`},{id:14,name:"æ ¼å…°å ‚",icon:`${n}/sysu_014_gelan_hall.png`},{id:15,name:"å»–æ‰¿å¿—åƒ",icon:`${n}/sysu_015_liao_chengzhi_statue.png`},{id:16,name:"é©¬ä¸å ‚",icon:`${n}/sysu_016_martin_hall.png`},{id:17,name:"é™„å±žå°å­¦å»ºç­‘ç¾¤",icon:`${n}/sysu_017_affiliated_primary_school_complex.png`},{id:18,name:"å—è‰åªé¤åŽ…",icon:`${n}/sysu_018_south_lawn_dining_hall.png`},{id:19,name:"ç¬¬ä¸€æ•™å­¦æ¥¼",icon:`${n}/sysu_019_teaching_building_1.png`},{id:20,name:"é™„å±žå°å­¦æ–¹äº­",icon:`${n}/sysu_020_affiliated_primary_school_pavilion.png`},{id:21,name:"è£å…‰å ‚",icon:`${n}/sysu_021_rongguang_hall.png`},{id:22,name:"ä¸­å±±å¤§å­¦å—é—¨",icon:`${n}/sysu_022_sysu_south_gate.png`},{id:23,name:"ç”Ÿå‘½ç§‘å­¦æ¥¼",icon:`${n}/sysu_023_life_sciences_building.png`},{id:24,name:"èš•ä¸å­¦é™¢åˆ¶ç§å®¤",icon:`${n}/sysu_024_sericulture_institute_breeding_room.png`},{id:25,name:"ç”Ÿç‰©æ¥¼",icon:`${n}/sysu_025_biology_building.png`},{id:26,name:"è¾¾å°”æ–‡é›•å¡‘",icon:`${n}/sysu_026_charles_darwin_sculpture.png`},{id:27,name:"æ›¾å®ªæ¢“å ‚",icon:`${n}/sysu_027_zeng_xianzhi_hall.png`},{id:28,name:"è’²è›°é¾™é›•å¡‘",icon:`${n}/sysu_028_pu_zhelong_sculpture.png`},{id:29,name:"é©¬æ–‡è¾‰å ‚",icon:`${n}/sysu_029_ma_wenhui_hall.png`},{id:30,name:"è´ºä¸¹é’å ‚",icon:`${n}/sysu_030_he_danqing_hall.png`},{id:31,name:"æµ‹è¯•å¤§æ¥¼",icon:`${n}/sysu_031_test_building.png`},{id:32,name:"ç«¹æž—",icon:`${n}/sysu_032_bamboo_grove.png`},{id:33,name:"ä¸­å±±æ¥¼",icon:`${n}/sysu_033_zhongshan_building.png`},{id:34,name:"æ¢éŠ¶çšå ‚",icon:`${n}/sysu_034_liang_xiju_hall.png`},{id:35,name:"ç ”ç©¶ç”Ÿé™¢",icon:`${n}/sysu_035_yanjiushengyuan.png`},{id:36,name:"å¼ å¼¼å£«å ‚",icon:`${n}/sysu_036_zhang_bishi_hall.png`},{id:37,name:"é€¸å¤«æ¥¼",icon:`${n}/sysu_037_yifu_building.png`},{id:38,name:"è¥¿å¤§æ“åœº",icon:`${n}/sysu_038_west_field.png`},{id:39,name:"æ´—ä¸ºåšå ‚",icon:`${n}/sysu_039_xi_weijian_hall.png`},{id:40,name:"ç´«è†å›­é¤åŽ…",icon:`${n}/sysu_040_bauhinia_garden_dining_hall.png`},{id:41,name:"åå’Œç¥žå­¦é™¢å»ºç­‘ç¾¤",icon:`${n}/sysu_041_union_theological_seminary_complex.png`},{id:42,name:"èŠ™å…°å ‚",icon:`${n}/sysu_042_teaching_building_3.png`},{id:43,name:"é”¡æ˜Œå ‚",icon:`${n}/sysu_043_xichang_hall.png`},{id:44,name:"å››å¢©æ¥¼",icon:`${n}/sysu_044_sidun_building.png`},{id:45,name:"8å·ä½å®…",icon:`${n}/sysu_045_residence_no8.png`},{id:46,name:"å­–å±‹äºŒ",icon:`${n}/sysu_046_twin_house_no2.png`},{id:47,name:"è°­ç¤¼åº­å±‹",icon:`${n}/sysu_047_tan_liting_house.png`},{id:48,name:"é©¬åº”å½ªå¤«äººæŠ¤å…»é™¢",icon:`${n}/sysu_048_madam_ma_yingbiao_convalescent_home.png`},{id:49,name:"éº»é‡‘å¢¨å±‹äºŒå·",icon:`${n}/sysu_049_ma_jinmo_house_no2.png`},{id:50,name:"æ€€å£«å ‚",icon:`${n}/sysu_050_huaishi_hall.png`},{id:51,name:"é²è¿…å…ˆç”Ÿåƒ",icon:`${n}/sysu_051_lu_xun_statue.png`},{id:52,name:"æ ¡è®­é›•åƒ",icon:`${n}/sysu_052_school_motto_stone_carving.png`},{id:53,name:"å¸Œä¼¦é«˜å±‹",icon:`${n}/sysu_053_xi_lungao_house.png`},{id:54,name:"é»‘çŸ³å±‹",icon:`${n}/sysu_054_blackstone_house.png`},{id:55,name:"éº»é‡‘å¢¨å±‹ä¸€å·",icon:`${n}/sysu_055_ma_jinmo_house_no1.png`},{id:56,name:"ç¾Žè‡£å±‹äºŒå·",icon:`${n}/sysu_056_meichen_house_no2.png`},{id:57,name:"ç¥žç”«å±‹",icon:`${n}/sysu_057_priest_house.png`},{id:58,name:"ç§¯è‡£å±‹",icon:`${n}/sysu_058_jichen_house.png`},{id:59,name:"è‹±ä¸œä½“è‚²é¦†",icon:`${n}/sysu_059_yingdong_stadium.png`},{id:60,name:"æ–°å¥³å­¦",icon:`${n}/sysu_060_new_womens_school.png`},{id:61,name:"â€œæ‘‡ç¯®â€é“œåƒ",icon:`${n}/sysu_061_cradle_bronze_statue.png`},{id:62,name:"å†¼æ˜Ÿæµ·åŠèº«é“œåƒ",icon:`${n}/sysu_062_xian_xinghai_bust.png`},{id:63,name:"ç¿˜ç‡Šå ‚ã€æ–‡è™Žå ‚",icon:`${n}/sysu_063_qiaoshen_hall_and_wenhu_hall.png`},{id:64,name:"æ¾æ¶›å›­",icon:`${n}/sysu_064_songtao_garden.png`},{id:65,name:"æ–°ä½“è‚²é¦†",icon:`${n}/sysu_065_new_gymnasium.png`},{id:66,name:"æ¾å›­æ¹–",icon:`${n}/sysu_066_songyuan_lake.png`},{id:67,name:"ç¬¬äºŒæ•™å­¦æ¥¼",icon:`${n}/sysu_067_teaching_building_2.png`},{id:68,name:"å¡å½­ç‰¹æ¥¼",icon:`${n}/sysu_068_carpenter_building.png`},{id:69,name:"æž—æŠ¤å ‚ã€é»„é“­è¡å ‚ã€é»„ä¼ ç»å ‚",icon:`${n}/sysu_069_linhu_hall_huang_mingyan_hall_huang_chuanjing_hall.png`},{id:70,name:"å¶è‘†å®šå ‚",icon:`${n}/sysu_070_ye_baoding_hall.png`},{id:71,name:"ä¸­å±±å¤§å­¦åŒ—é—¨ç‰ŒåŠ",icon:`${n}/sysu_071_north_gate_archway.png`},{id:72,name:"ä¼æ²¾å¾·å ‚",icon:`${n}/sysu_072_wu_zhande_hall.png`},{id:73,name:"ä¸°ç››å ‚",icon:`${n}/sysu_073_fengsheng_hall.png`},{id:74,name:"ä¸­å±±å¤§å­¦è¥¿åŒ—é—¨",icon:`${n}/sysu_074_northwest_gate.png`},{id:75,name:"ä¼èˆœå¾·å›¾ä¹¦é¦†",icon:`${n}/sysu_075_wu_shunde_library.png`},{id:76,name:"å²­å—å ‚",icon:`${n}/sysu_076_lingnan_hall.png`},{id:77,name:"é©¬åº”å½ªæ‹›å¾…å®¤",icon:`${n}/sysu_077_ma_yingbiao_reception_room.png`},{id:78,name:"å“²ç”Ÿå ‚",icon:`${n}/sysu_078_zhesheng_hall.png`},{id:79,name:"é™†ä½‘å ‚",icon:`${n}/sysu_079_lu_you_hall.png`},{id:80,name:"çˆªå“‡å ‚",icon:`${n}/sysu_080_java_hall.png`},{id:81,name:"åšç‰©é¦†",icon:`${n}/sysu_081_museum.png`},{id:82,name:"å…«è§’äº­",icon:`${n}/sysu_082_octagonal_pavilion.png`},{id:83,name:"ä¹™ä¸‘è¿›å£«ç‰ŒåŠ",icon:`${n}/sysu_083_yichou_jinshi_archway.png`},{id:84,name:"æƒºäº­",icon:`${n}/sysu_084_xing_pavilion.png`},{id:85,name:"å­™ä¸­å±±å…ˆç”Ÿé“œåƒ",icon:`${n}/sysu_085_sun_yat_sen_bronze_statue.png`},{id:86,name:"å²è¾¾ç†å ‚",icon:`${n}/sysu_086_shidali_hall.png`},{id:87,name:"æ¿€å…‰å…‰å­¦å¤§æ¥¼",icon:`${n}/sysu_087_long_kanghou_sculpture.png`},{id:88,name:"åå‹å ‚",icon:`${n}/sysu_088_shiyou_hall.png`},{id:89,name:"æ¨¡èŒƒæ‘",icon:`${n}/sysu_089_model_village.png`},{id:90,name:"æ³•å­¦é™¢",icon:`${n}/sysu_090_law_college.png`},{id:91,name:"æ°¸èŠ³å ‚",icon:`${n}/sysu_091_yongfang_hall.png`},{id:92,name:"äººå£ç ”ç©¶æ‰€",icon:`${n}/sysu_092_people_research_academic.png`},{id:93,name:"å­¦äººä¹¦å¢ƒ",icon:`${n}/sysu_093_SYSU_publishinghouse.png`},{id:94,name:"ä¸­å±±å¤§å­¦äººæ–‡é«˜ç­‰ç ”ç©¶é™¢",icon:`${n}/sysu_094_deng_shichang_navy_statue.png`},{id:95,name:"åº·ä¹å›­é¤åŽ…",icon:`${n}/sysu_095_kangle_garden_dining_hall.png`},{id:96,name:"å›­è¥¿æ¹–",icon:`${n}/sysu_096_yuanxi_lake.png`},{id:97,name:"è’²å›­é£Ÿå ‚",icon:`${n}/sysu_097_puyuan_canteen.png`},{id:98,name:"ä¸­å±±å¤§å­¦è¥¿é—¨",icon:`${n}/sysu_098_west_gate.png`},{id:99,name:"ä¸­å±±å¤§å­¦å°è¥¿é—¨",icon:`${n}/sysu_099_small_west_gate.png`},{id:100,name:"éœ‡å¯°å ‚",icon:`${n}/sysu_100_zhenhuan_hall.png`},{id:101,name:"ä½ çš„è§é—»",icon:`${n}/sysu_101_your_observations.png`}],x=K(),c=l({}),z=l("visitor"),d=l([]),v=l(0),f=l("0%"),b=l(!1),k=l(null);let g=null;function U(){"IntersectionObserver"in window&&(g=new IntersectionObserver(i=>{i.forEach(s=>{if(!s.isIntersecting)return;const e=Array.from(document.querySelectorAll(".badge-img"));let o=0;for(const t of e){if(o>=15)break;const _=t.getAttribute("data-src");if(_&&!t.src){const u=document.createElement("link");u.rel="prefetch",u.as="image",u.href=_,document.head.appendChild(u),o++}}})},{rootMargin:"1000px"}),k.value&&g.observe(k.value))}function M(){g&&(g.disconnect(),g=null)}function R(i,s){c.value=i||{},z.value=i&&i.role||"visitor";const e=new Set(s||[]),o=S.map(_=>({..._,thumb:w(_.icon,256,75),unlocked:e.has(_.id)}));d.value=o;const t=o.filter(_=>_.unlocked).length;v.value=t,f.value=o.length?`${Math.round(t/o.length*100)}%`:"0%"}J(async()=>{var s,e,o,t;if(document.title="æˆ‘çš„æ‰“å¡",!localStorage.getItem("token")){x.push({path:"/signin",query:{redirect:encodeURIComponent("/myCheckins")}});return}b.value=!0;try{const _=JSON.parse(sessionStorage.getItem(q)||"null"),u=JSON.parse(sessionStorage.getItem(O)||"null");_&&u&&R(_,u)}catch{}try{const[_,u]=await Promise.allSettled([j("/auth/me","GET",null,{credentials:"include"}),j("/checkin/status","GET",null,{credentials:"include"})]);if(_.status!=="fulfilled"||((e=(s=_.value)==null?void 0:s.data)==null?void 0:e.code)!==0){x.push({path:"/signin",query:{redirect:encodeURIComponent("/myCheckins")}});return}const h=_.value.data.userInfo||{};c.value=h,z.value=h.role||"visitor";const L=JSON.parse(localStorage.getItem("userInfo")||"{}");localStorage.setItem("userInfo",JSON.stringify({...L,...h})),sessionStorage.setItem(q,JSON.stringify(c.value));let I=new Set(h.unlockedLocations||[]);u.status==="fulfilled"&&((t=(o=u.value)==null?void 0:o.data)==null||t.code),sessionStorage.setItem(O,JSON.stringify(Array.from(I)));const $=S.map(r=>({...r,thumb:w(r.icon,256,75),unlocked:I.has(r.id)}));d.value=$;const C=$.filter(r=>r.unlocked).length;v.value=C,requestAnimationFrame(()=>{f.value=$.length?`${Math.round(C/$.length*100)}%`:"0%"})}catch(_){console.error("[myCheckins:init]",_),alert("åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åŽé‡è¯•")}finally{b.value=!1,U()}}),T(()=>{M()});function A(i){const s=d.value.find(e=>e.id===i);s&&(s.unlocked?alert(`å·²è§£é”ï¼š${s.name}`):alert(`å°šæœªè§£é”ï¼š${s.name}`))}return(i,s)=>(y(),m("div",{class:"bg-wrapper",onContextmenu:s[0]||(s[0]=P(()=>{},["prevent"]))},[s[4]||(s[4]=a("img",{class:"bg-img",src:"https://sysuzngcxy-1322240898.cos.ap-guangzhou.myqcloud.com/bg.jpg",alt:"bg",draggable:"false"},null,-1)),a("div",H,[s[2]||(s[2]=a("div",{class:"logo-container"},[a("img",{class:"logo-img",src:"https://sysuzngcxy-1322240898.cos.ap-guangzhou.myqcloud.com/logo1.png",alt:"logo",draggable:"false"})],-1)),a("div",W,[a("img",{class:"avatar",src:c.value.avatar||"https://img.yzcdn.cn/vant/user-active.png",alt:"avatar",draggable:"false"},null,8,Q),a("div",X,[a("div",Z,p(c.value.username||"æœªç™»å½•ç”¨æˆ·"),1),a("div",nn,"IDï¼š"+p(c.value.id||"-"),1)]),a("div",sn,[a("div",en,"å¾½ç« è¿›åº¦ï¼š"+p(v.value)+" / "+p(d.value.length),1),a("div",an,[a("div",{class:"progress-inner",style:V({width:f.value})},null,4)])])]),s[3]||(s[3]=a("div",{class:"section-head"},[a("span",{class:"section-emoji"},"ðŸ…"),a("span",{class:"section-title"},"å¾½ç« å¢™")],-1)),a("div",on,[(y(!0),m(D,null,F(d.value,e=>(y(),m("div",{key:e.id,class:Y(["badge-card",e.unlocked?"is-unlocked":"is-locked"]),onClick:o=>A(e.id)},[a("div",{class:"badge-thumb",title:e.name},[G(a("img",{class:"badge-img",alt:e.name,loading:"lazy",decoding:"async",fetchpriority:"low",draggable:"false"},null,8,un),[[E,e.thumb]]),e.unlocked?N("",!0):(y(),m("div",ln,s[1]||(s[1]=[a("span",{class:"lock"},"ðŸ”’",-1)])))],8,tn),a("span",cn,p(e.name),1)],10,_n))),128)),a("div",{ref_key:"sentinel",ref:k,style:{height:"1px"}},null,512)]),b.value?(y(),m("div",dn,"åŠ è½½ä¸­â€¦")):N("",!0)])],32))}},yn=B(gn,[["__scopeId","data-v-96b176a2"]]);export{yn as default};
